@{
    Layout = "~/Views/Shared/_ThemeLayout.cshtml";
}

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<div class="min-h-screen bg-gray-100 py-8 px-4 sm:px-6 lg:px-8">
    <div class="max-w-5xl mx-auto">
        <div class="bg-white shadow-lg rounded-xl overflow-hidden">
            <!-- Header -->
            <div class="bg-gradient-to-r from-blue-700 to-indigo-700 px-6 py-4">
                <h2 class="text-2xl font-semibold text-white text-center">
                    <i class="fas fa-cogs mr-2"></i>
                    Quản Lý Cài Đặt
                </h2>
            </div>

            <div class="border-b border-gray-200 bg-gray-50">
                <div class="flex flex-wrap justify-center sm:justify-start">
                    <button class="tablinks px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 active" onclick="openTab(event, 'MucLuongToiThieuVung')">
                        Mức Lương Tối Thiểu Vùng
                    </button>
                    <button class="tablinks px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="openTab(event, 'MucLuongCoSo')">
                        Mức Lương Cơ Sở
                    </button>
                    <button class="tablinks px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="openTab(event, 'ThongTinBaoHiem')">
                        Thông Tin Bảo Hiểm
                    </button>
                    <button class="tablinks px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="openTab(event, 'CauHinhLuongThue')">
                        Cấu Hình Lương Thuế
                    </button>
                    <button class="tablinks px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="openTab(event, 'GiamTruGiaCanh')">
                        Giảm Trừ Gia Cảnh
                    </button>
                </div>
            </div>

            <!-- Tab Content -->
            <div id="MucLuongToiThieuVung" class="tabcontent p-4 sm:p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Mức Lương Tối Thiểu Vùng</h3>
                <div class="overflow-x-auto">
                    <table id="mucLuongToiThieuVungTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Vùng Lương</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Mức Lương Tối Thiểu Tháng</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Mức Lương Tối Thiểu Giờ</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Trạng Thái</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Thao Tác</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="MucLuongCoSo" class="tabcontent p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-800">Mức Lương Cơ Sở</h3>
                    <div class="space-x-2">
                        <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm" onclick="openCreateMucLuongCoSoModal()">
                            <i class="fas fa-plus mr-1"></i>Tạo Mới
                        </button>
                        <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-gray-600 text-white hover:bg-gray-700 transition-colors text-sm" onclick="openHistoryMucLuongCoSoModal()">
                            <i class="fas fa-history mr-1"></i>Lịch Sử
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table id="mucLuongCoSoTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">ID</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Lương Cơ Sở</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ngày Hiệu Lực</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ngày Hết Hiệu Lực</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ghi Chú</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Thao Tác</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="ThongTinBaoHiem" class="tabcontent p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-800">Thông Tin Bảo Hiểm</h3>
                    <div class="space-x-2">
                        <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm" onclick="openCreateThongTinBaoHiemModal()">
                            <i class="fas fa-plus mr-1"></i>Tạo Mới
                        </button>
                        <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-gray-600 text-white hover:bg-gray-700 transition-colors text-sm" onclick="openHistoryThongTinBaoHiemModal()">
                            <i class="fas fa-history mr-1"></i>Lịch Sử
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table id="thongTinBaoHiemTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-16">ID</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-24">Tỷ Lệ NLĐ (%)</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-24">Tỷ Lệ NTD (%)</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-28">Ngày Hiệu Lực</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-28">Ngày Hết Hiệu Lực</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-32">Ghi Chú</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-20">Thao Tác</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="CauHinhLuongThue" class="tabcontent p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-800">Cấu Hình Lương Thuế</h3>
                    <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm" onclick="openCreateCauHinhLuongThueModal()">
                        <i class="fas fa-plus mr-1"></i>Tạo Mới
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table id="cauHinhLuongThueTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Mã Cấu Hình</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Mức Lương Từ</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Mức Lương Đến</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Giá Trị</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Mô Tả</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Thao Tác</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div id="GiamTruGiaCanh" class="tabcontent p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-800">Giảm Trừ Gia Cảnh</h3>
                    <div class="space-x-2">
                        <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm" onclick="openCreateGiamTruGiaCanhModal()">
                            <i class="fas fa-plus mr-1"></i>Tạo Mới
                        </button>
                        <button class="inline-flex items-center px-3 py-1.5 rounded-lg bg-gray-600 text-white hover:bg-gray-700 transition-colors text-sm" onclick="openHistoryGiamTruGiaCanhModal()">
                            <i class="fas fa-history mr-1"></i>Lịch Sử
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table id="giamTruGiaCanhTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-16">Đợt</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-28">Giảm Trừ Bản Thân</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-28">Giảm Trừ Người PT</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-28">Ngày Hiệu Lực</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-28">Ngày Hết Hiệu Lực</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-32">Ghi Chú</th>
                                <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap w-20">Thao Tác</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- Create Modals -->
<div id="createMucLuongCoSoModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Tạo Mới Mức Lương Cơ Sở</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('createMucLuongCoSoModal')">×</span>
        </div>
        <form id="createMucLuongCoSoForm" class="space-y-4">
            <div>
                <label for="createLuongCoSo" class="block text-sm font-medium text-gray-700">Lương Cơ Sở:</label>
                <input type="number" id="createLuongCoSo" name="luongCoSo" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createNgayHieuLucCoSo" class="block text-sm font-medium text-gray-700">Ngày Hiệu Lực:</label>
                <input type="date" id="createNgayHieuLucCoSo" name="ngayHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createNgayHetHieuLucCoSo" class="block text-sm font-medium text-gray-700">Ngày Hết Hiệu Lực:</label>
                <input type="date" id="createNgayHetHieuLucCoSo" name="ngayHetHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm">
            </div>
            <div>
                <label for="createGhiChuCoSo" class="block text-sm font-medium text-gray-700">Ghi Chú:</label>
                <textarea id="createGhiChuCoSo" name="ghiChu" rows="3" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm"></textarea>
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Tạo</button>
        </form>
    </div>
</div>

<div id="createThongTinBaoHiemModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-4 w-full max-w-3xl max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-3">
            <h2 class="text-base font-semibold text-gray-800">Tạo Mới Thông Tin Bảo Hiểm</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-xl" onclick="closeModal('createThongTinBaoHiemModal')">×</span>
        </div>
        <form id="createThongTinBaoHiemForm" class="space-y-3">
            <!-- Phần trên: BHXH, BHYT, BHTN chia 3 cột -->
            <div class="grid grid-cols-3 gap-4 mb-4">
                <!-- Cột 1: BHXH -->
                <div class="space-y-3">
                    <div class="insurance-section border border-gray-200 p-3 rounded-lg">
                        <h4 class="text-sm font-medium text-gray-700 mb-1">BHXH</h4>
                        <div class="space-y-2">
                            <div>
                                <label for="createTyLeNguoiLaoDongBHXH" class="block text-xs font-medium text-gray-700">Tỷ Lệ Người Lao Động (%):</label>
                                <input type="number" step="0.01" id="createTyLeNguoiLaoDongBHXH" name="tyLeNguoiLaoDongBHXH" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                            </div>
                            <div>
                                <label for="createTyLeNhaTuyenDungBHXH" class="block text-xs font-medium text-gray-700">Tỷ Lệ Nhà Tuyển Dụng (%):</label>
                                <input type="number" step="0.01" id="createTyLeNhaTuyenDungBHXH" name="tyLeNhaTuyenDungBHXH" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Cột 2: BHYT -->
                <div class="space-y-3">
                    <div class="insurance-section border border-gray-200 p-3 rounded-lg">
                        <h4 class="text-sm font-medium text-gray-700 mb-1">BHYT</h4>
                        <div class="space-y-2">
                            <div>
                                <label for="createTyLeNguoiLaoDongBHYT" class="block text-xs font-medium text-gray-700">Tỷ Lệ Người Lao Động (%):</label>
                                <input type="number" step="0.01" id="createTyLeNguoiLaoDongBHYT" name="tyLeNguoiLaoDongBHYT" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                            </div>
                            <div>
                                <label for="createTyLeNhaTuyenDungBHYT" class="block text-xs font-medium text-gray-700">Tỷ Lệ Nhà Tuyển Dụng (%):</label>
                                <input type="number" step="0.01" id="createTyLeNhaTuyenDungBHYT" name="tyLeNhaTuyenDungBHYT" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Cột 3: BHTN -->
                <div class="space-y-3">
                    <div class="insurance-section border border-gray-200 p-3 rounded-lg">
                        <h4 class="text-sm font-medium text-gray-700 mb-1">BHTN</h4>
                        <div class="space-y-2">
                            <div>
                                <label for="createTyLeNguoiLaoDongBHTN" class="block text-xs font-medium text-gray-700">Tỷ Lệ Người Lao Động (%):</label>
                                <input type="number" step="0.01" id="createTyLeNguoiLaoDongBHTN" name="tyLeNguoiLaoDongBHTN" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                            </div>
                            <div>
                                <label for="createTyLeNhaTuyenDungBHTN" class="block text-xs font-medium text-gray-700">Tỷ Lệ Nhà Tuyển Dụng (%):</label>
                                <input type="number" step="0.01" id="createTyLeNhaTuyenDungBHTN" name="tyLeNhaTuyenDungBHTN" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Phần dưới: Thông tin khác -->
            <div class="space-y-3">
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label for="createNgayHieuLucBH" class="block text-xs font-medium text-gray-700">Ngày Hiệu Lực:</label>
                        <input type="date" id="createNgayHieuLucBH" name="ngayHieuLuc" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                    </div>
                    <div>
                        <label for="createNgayHetHieuLucBH" class="block text-xs font-medium text-gray-700">Ngày Hết Hiệu Lực:</label>
                        <input type="date" id="createNgayHetHieuLucBH" name="ngayHetHieuLuc" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs">
                    </div>
                    <div class="col-span-3">
                        <label for="createGhiChuBH" class="block text-xs font-medium text-gray-700">Ghi Chú:</label>
                        <textarea id="createGhiChuBH" name="ghiChu" rows="1" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs"></textarea>
                    </div>
                </div>
            </div>
            <button type="submit" class="w-full mt-4 px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-xs">Tạo</button>
        </form>
    </div>
</div>

<div id="createCauHinhLuongThueModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Tạo Mới Cấu Hình Lương Thuế</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('createCauHinhLuongThueModal')">×</span>
        </div>
        <form id="createCauHinhLuongThueForm" class="space-y-4">
            <div>
                <label for="createMucLuongTu" class="block text-sm font-medium text-gray-700">Mức Lương Từ:</label>
                <input type="number" step="0.01" id="createMucLuongTu" name="mucLuongTu" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createMucLuongDen" class="block text-sm font-medium text-gray-700">Mức Lương Đến:</label>
                <input type="number" step="0.01" id="createMucLuongDen" name="mucLuongDen" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm">
            </div>
            <div>
                <label for="createGiaTri" class="block text-sm font-medium text-gray-700">Giá Trị:</label>
                <input type="number" step="0.01" id="createGiaTri" name="giaTri" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createMoTa" class="block text-sm font-medium text-gray-700">Mô Tả:</label>
                <textarea id="createMoTa" name="moTa" rows="3" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm"></textarea>
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Tạo</button>
        </form>
    </div>
</div>

<!-- Create Modal for GiamTruGiaCanh -->
<div id="createGiamTruGiaCanhModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Tạo Mới Giảm Trừ Gia Cảnh</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('createGiamTruGiaCanhModal')">×</span>
        </div>
        <form id="createGiamTruGiaCanhForm" class="space-y-4">
            <div>
                <label for="createMucGiamTruBanThan" class="block text-sm font-medium text-gray-700">Giảm Trừ Bản Thân (VNĐ):</label>
                <input type="number" id="createMucGiamTruBanThan" name="mucGiamTruBanThan" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createMucGiamTruNguoiPhuThuoc" class="block text-sm font-medium text-gray-700">Giảm Trừ Người Phụ Thuộc (VNĐ):</label>
                <input type="number" id="createMucGiamTruNguoiPhuThuoc" name="mucGiamTruNguoiPhuThuoc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createNgayHieuLucGTGC" class="block text-sm font-medium text-gray-700">Ngày Hiệu Lực:</label>
                <input type="date" id="createNgayHieuLucGTGC" name="ngayHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="createNgayHetHieuLucGTGC" class="block text-sm font-medium text-gray-700">Ngày Hết Hiệu Lực:</label>
                <input type="date" id="createNgayHetHieuLucGTGC" name="ngayHetHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm">
            </div>
            <div>
                <label for="createGhiChuGTGC" class="block text-sm font-medium text-gray-700">Ghi Chú:</label>
                <textarea id="createGhiChuGTGC" name="ghiChu" rows="3" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm"></textarea>
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Tạo</button>
        </form>
    </div>
</div>

<!-- History Modals -->
<div id="historyMucLuongCoSoModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Lịch Sử Mức Lương Cơ Sở</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('historyMucLuongCoSoModal')">×</span>
        </div>
        <div class="overflow-x-auto">
            <table id="historyMucLuongCoSoTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">ID</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Lương Cơ Sở</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ngày Hiệu Lực</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ngày Hết Hiệu Lực</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ghi Chú</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<div id="historyThongTinBaoHiemModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-5xl max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Lịch Sử Thông Tin Bảo Hiểm</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('historyThongTinBaoHiemModal')">×</span>
        </div>
        <div class="overflow-x-auto">
            <table id="historyThongTinBaoHiemTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">ID</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Loại Bảo Hiểm</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Tỷ Lệ Người Lao Động (%)</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Tỷ Lệ Nhà Tuyển Dụng (%)</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ngày Hiệu Lực</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ngày Hết Hiệu Lực</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b">Ghi Chú</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<!-- History Modal for GiamTruGiaCanh -->
<div id="historyGiamTruGiaCanhModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Lịch Sử Giảm Trừ Gia Cảnh</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('historyGiamTruGiaCanhModal')">×</span>
        </div>
        <div class="overflow-x-auto">
            <table id="historyGiamTruGiaCanhTable" class="min-w-full bg-white border border-gray-200 rounded-lg">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap">Đợt</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap">Giảm Trừ Bản Thân</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap">Giảm Trừ Người PT</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap">Ngày Hiệu Lực</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap">Ngày Hết Hiệu Lực</th>
                        <th class="px-4 py-2 text-sm font-medium text-gray-700 border-b whitespace-nowrap">Ghi Chú</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<!-- Edit Modals -->
<div id="editMucLuongToiThieuVungModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Chỉnh Sửa Mức Lương Tối Thiểu Vùng</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('editMucLuongToiThieuVungModal')">×</span>
        </div>
        <form id="editMucLuongToiThieuVungForm" class="space-y-4">
            <input type="hidden" id="editMucLuongToiThieuVungId" name="vungLuong">
            <div>
                <label for="editMucLuongToiThieuThang" class="block text-sm font-medium text-gray-700">Mức Lương Tối Thiểu Tháng:</label>
                <input type="number" id="editMucLuongToiThieuThang" name="mucLuongToiThieuThang" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editMucLuongToiThieuGio" class="block text-sm font-medium text-gray-700">Mức Lương Tối Thiểu Giờ:</label>
                <input type="number" id="editMucLuongToiThieuGio" name="mucLuongToiThieuGio" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editIsActive" class="block text-sm font-medium text-gray-700">Kích Hoạt:</label>
                <input type="checkbox" id="editIsActive" name="isActive" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Lưu</button>
        </form>
    </div>
</div>

<div id="editMucLuongCoSoModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Chỉnh Sửa Mức Lương Cơ Sở</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('editMucLuongCoSoModal')">×</span>
        </div>
        <form id="editMucLuongCoSoForm" class="space-y-4">
            <input type="hidden" id="editMucLuongCoSoId" name="id">
            <div>
                <label for="editLuongCoSo" class="block text-sm font-medium text-gray-700">Lương Cơ Sở:</label>
                <input type="number" id="editLuongCoSo" name="luongCoSo" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editNgayHieuLucCoSo" class="block text-sm font-medium text-gray-700">Ngày Hiệu Lực:</label>
                <input type="date" id="editNgayHieuLucCoSo" name="ngayHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editNgayHetHieuLucCoSo" class="block text-sm font-medium text-gray-700">Ngày Hết Hiệu Lực:</label>
                <input type="date" id="editNgayHetHieuLucCoSo" name="ngayHetHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm">
            </div>
            <div>
                <label for="editGhiChuCoSo" class="block text-sm font-medium text-gray-700">Ghi Chú:</label>
                <textarea id="editGhiChuCoSo" name="ghiChu" rows="3" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm"></textarea>
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Lưu</button>
        </form>
    </div>
</div>

<div id="editThongTinBaoHiemModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-4 w-full max-w-xl max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-3">
            <h2 class="text-base font-semibold text-gray-800">Chỉnh Sửa Thông Tin Bảo Hiểm</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-xl" onclick="closeModal('editThongTinBaoHiemModal')">×</span>
        </div>
        <form id="editThongTinBaoHiemForm" class="space-y-3">
            <input type="hidden" id="editThongTinBaoHiemId" name="id">
            <div class="grid grid-cols-2 gap-4">
                <!-- Cột trái: Loại Bảo Hiểm và Tỷ Lệ -->
                <div class="space-y-3">
                    <div>
                        <label for="editLoaiBaoHiemDisplay" class="block text-xs font-medium text-gray-700">Loại Bảo Hiểm:</label>
                        <input type="text" id="editLoaiBaoHiemDisplay" class="w-full px-2 py-1 rounded-lg border border-gray-300 bg-gray-100 text-xs" readonly>
                        <input type="hidden" id="editLoaiBaoHiem" name="loaiBaoHiem">
                    </div>
                    <div>
                        <label for="editTyLeNguoiLaoDong" class="block text-xs font-medium text-gray-700">Tỷ Lệ Người Lao Động (%):</label>
                        <input type="number" step="0.01" id="editTyLeNguoiLaoDong" name="tyLeNguoiLaoDong" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                    </div>
                    <div>
                        <label for="editTyLeNhaTuyenDung" class="block text-xs font-medium text-gray-700">Tỷ Lệ Nhà Tuyển Dụng (%):</label>
                        <input type="number" step="0.01" id="editTyLeNhaTuyenDung" name="tyLeNhaTuyenDung" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                    </div>
                </div>
                <!-- Cột phải: Thông tin khác -->
                <div class="space-y-3">
                    <div>
                        <label for="editNgayHieuLucBH" class="block text-xs font-medium text-gray-700">Ngày Hiệu Lực:</label>
                        <input type="date" id="editNgayHieuLucBH" name="ngayHieuLuc" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs" required>
                    </div>
                    <div>
                        <label for="editNgayHetHieuLucBH" class="block text-xs font-medium text-gray-700">Ngày Hết Hiệu Lực:</label>
                        <input type="date" id="editNgayHetHieuLucBH" name="ngayHetHieuLuc" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs">
                    </div>
                    <div>
                        <label for="editGhiChuBH" class="block text-xs font-medium text-gray-700">Ghi Chú:</label>
                        <textarea id="editGhiChuBH" name="ghiChu" rows="2" class="w-full px-2 py-1 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-xs"></textarea>
                    </div>
                </div>
            </div>
            <button type="submit" class="w-full mt-4 px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-xs">Lưu</button>
        </form>
    </div>
</div>

<div id="editCauHinhLuongThueModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Chỉnh Sửa Cấu Hình Lương Thuế</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('editCauHinhLuongThueModal')">×</span>
        </div>
        <form id="editCauHinhLuongThueForm" class="space-y-4">
            <input type="hidden" id="editMaCauHinh" name="maCauHinh">
            <div>
                <label for="editMucLuongTu" class="block text-sm font-medium text-gray-700">Mức Lương Từ:</label>
                <input type="number" step="0.01" id="editMucLuongTu" name="mucLuongTu" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editMucLuongDen" class="block text-sm font-medium text-gray-700">Mức Lương Đến:</label>
                <input type="number" step="0.01" id="editMucLuongDen" name="mucLuongDen" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm">
            </div>
            <div>
                <label for="editGiaTri" class="block text-sm font-medium text-gray-700">Giá Trị:</label>
                <input type="number" step="0.01" id="editGiaTri" name="giaTri" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editMoTa" class="block text-sm font-medium text-gray-700">Mô Tả:</label>
                <textarea id="editMoTa" name="moTa" rows="3" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm"></textarea>
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Lưu</button>
        </form>
    </div>
</div>

<!-- Edit Modal for GiamTruGiaCanh -->
<div id="editGiamTruGiaCanhModal" class="modal fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
    <div class="modal-content bg-white rounded-lg p-6 w-full max-w-md max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold text-gray-800">Chỉnh Sửa Giảm Trừ Gia Cảnh</h2>
            <span class="close text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="closeModal('editGiamTruGiaCanhModal')">×</span>
        </div>
        <form id="editGiamTruGiaCanhForm" class="space-y-4">
            <input type="hidden" id="editGiamTruGiaCanhId" name="id">
            <div>
                <label for="editMucGiamTruBanThan" class="block text-sm font-medium text-gray-700">Giảm Trừ Bản Thân (VNĐ):</label>
                <input type="number" id="editMucGiamTruBanThan" name="mucGiamTruBanThan" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editMucGiamTruNguoiPhuThuoc" class="block text-sm font-medium text-gray-700">Giảm Trừ Người Phụ Thuộc (VNĐ):</label>
                <input type="number" id="editMucGiamTruNguoiPhuThuoc" name="mucGiamTruNguoiPhuThuoc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editNgayHieuLucGTGC" class="block text-sm font-medium text-gray-700">Ngày Hiệu Lực:</label>
                <input type="date" id="editNgayHieuLucGTGC" name="ngayHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm" required>
            </div>
            <div>
                <label for="editNgayHetHieuLucGTGC" class="block text-sm font-medium text-gray-700">Ngày Hết Hiệu Lực:</label>
                <input type="date" id="editNgayHetHieuLucGTGC" name="ngayHetHieuLuc" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm">
            </div>
            <div>
                <label for="editGhiChuGTGC" class="block text-sm font-medium text-gray-700">Ghi Chú:</label>
                <textarea id="editGhiChuGTGC" name="ghiChu" rows="3" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-sm"></textarea>
            </div>
            <button type="submit" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">Lưu</button>
        </form>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
            loadData(tabName);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = "none";
        }

        function loadData(tabName) {
            var apiUrl = "";
            var tableId = "";
            var html = "";

            switch (tabName) {
                case "MucLuongToiThieuVung":
                    apiUrl = "/api/PayrollSettingApi/muc-luong-toi-thieu-vung";
                    tableId = "#mucLuongToiThieuVungTable tbody";
                    $.ajax({
                        url: apiUrl,
                        method: "GET",
                        success: function (data) {
                            $(tableId).empty();
                            data.forEach(item => {
                                html += `<tr class="hover:bg-gray-50">
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.vungLuong}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.mucLuongToiThieuThang.toLocaleString()}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.mucLuongToiThieuGio.toLocaleString()}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.isActive ? 'Kích Hoạt' : 'Không Kích Hoạt'}</td>
                                    <td class="px-4 py-2 text-sm border-b">
                                        <button class="edit-button inline-flex items-center px-2 py-1 rounded-lg bg-yellow-500 text-white hover:bg-yellow-600 transition-colors text-xs" onclick="openEditMucLuongToiThieuVungModal(${item.vungLuong})">
                                            <i class="fas fa-edit mr-1"></i>Sửa
                                        </button>
                                    </td>
                                </tr>`;
                            });
                            $(tableId).html(html);
                        },
                        error: function (xhr) {
                            console.error("Error loading data for " + tabName, xhr);
                            $(tableId).html("<tr><td colspan='5' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                        }
                    });
                    break;
                case "MucLuongCoSo":
                    apiUrl = "/api/PayrollSettingApi/muc-luong-co-so";
                    tableId = "#mucLuongCoSoTable tbody";
                    $.ajax({
                        url: apiUrl,
                        method: "GET",
                        success: function (data) {
                            $(tableId).empty();
                            var activeRecords = data.filter(item => !item.ngayHetHieuLuc);
                            var latestRecord = activeRecords.sort((a, b) => new Date(b.ngayHieuLuc) - new Date(a.ngayHieuLuc))[0];
                            if (latestRecord) {
                                html += `<tr class="hover:bg-gray-50">
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${latestRecord.id}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${latestRecord.luongCoSo.toLocaleString()}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${new Date(latestRecord.ngayHieuLuc).toLocaleDateString()}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${latestRecord.ngayHetHieuLuc ? new Date(latestRecord.ngayHetHieuLuc).toLocaleDateString() : ''}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${latestRecord.ghiChu || ''}</td>
                                    <td class="px-4 py-2 text-sm border-b">
                                        <button class="edit-button inline-flex items-center px-2 py-1 rounded-lg bg-yellow-500 text-white hover:bg-yellow-600 transition-colors text-xs" onclick="openEditMucLuongCoSoModal(${latestRecord.id})">
                                            <i class="fas fa-edit mr-1"></i>Sửa
                                        </button>
                                    </td>
                                </tr>`;
                            }
                            $(tableId).html(html || "<tr><td colspan='6' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Không có dữ liệu hiện hành</td></tr>");
                        },
                        error: function (xhr) {
                            console.error("Error loading data for " + tabName, xhr);
                            $(tableId).html("<tr><td colspan='6' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                        }
                    });
                    break;
                    case "ThongTinBaoHiem":
                        apiUrl = "/api/PayrollSettingApi/thong-tin-bao-hiem";
                        tableId = "#thongTinBaoHiemTable tbody";
                        $.ajax({
                            url: apiUrl,
                            method: "GET",
                            success: function (data) {
                                $(tableId).empty();
                                var latestRecords = {};
                                var dot = 0; // Biến để đếm "Đợt"
                                ['BHXH', 'BHYT', 'BHTN'].forEach(type => {
                                    var latest = data
                                        .filter(item => item.loaiBaoHiem === type && !item.ngayHetHieuLuc)
                                        .sort((a, b) => new Date(b.ngayHieuLuc) - new Date(a.ngayHieuLuc))[0];
                                    if (latest) {
                                        latestRecords[type] = latest;
                                        dot++; // Tăng số "Đợt"
                                        html += `<tr class="hover:bg-gray-50">
                                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${dot}</td>
                                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${latest.tyLeNguoiLaoDong}</td>
                                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${latest.tyLeNhaTuyenDung}</td>
                                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${new Date(latest.ngayHieuLuc).toLocaleDateString()}</td>
                                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${latest.ngayHetHieuLuc ? new Date(latest.ngayHetHieuLuc).toLocaleDateString() : ''}</td>
                                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap">${latest.ghiChu || ''}</td>
                                            <td class="px-4 py-2 text-sm border-b whitespace-nowrap text-center">
                                                <button class="edit-button inline-flex items-center px-2 py-1 rounded-lg bg-yellow-500 text-white hover:bg-yellow-600 transition-colors text-xs" onclick="openEditThongTinBaoHiemModal(${latest.id})">
                                                    <i class="fas fa-edit mr-1"></i>Sửa
                                                </button>
                                            </td>
                                        </tr>`;
                                    }
                                });
                                $(tableId).html(html || "<tr><td colspan='7' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Không có dữ liệu hiện hành</td></tr>");
                            },
                            error: function (xhr) {
                                console.error("Error loading data for " + tabName, xhr);
                                $(tableId).html("<tr><td colspan='7' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                            }
                        });
                        break;
                case "CauHinhLuongThue":
                    apiUrl = "/api/PayrollSettingApi/cau-hinh-luong-thue";
                    tableId = "#cauHinhLuongThueTable tbody";
                    $.ajax({
                        url: apiUrl,
                        method: "GET",
                        success: function (data) {
                            $(tableId).empty();
                            data.forEach(item => {
                                html += `<tr class="hover:bg-gray-50">
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.maCauHinh}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.mucLuongTu ? item.mucLuongTu.toLocaleString() : ''}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.mucLuongDen ? item.mucLuongDen.toLocaleString() : ''}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.giaTri.toLocaleString()}</td>
                                    <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.moTa || ''}</td>
                                    <td class="px-4 py-2 text-sm border-b space-x-2">
                                        <button class="edit-button inline-flex items-center px-2 py-1 rounded-lg bg-yellow-500 text-white hover:bg-yellow-600 transition-colors text-xs" onclick="openEditCauHinhLuongThueModal(${item.maCauHinh})">
                                            <i class="fas fa-edit mr-1"></i>Sửa
                                        </button>
                                        <button class="delete-button inline-flex items-center px-2 py-1 rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors text-xs" onclick="deleteCauHinhLuongThue(${item.maCauHinh})">
                                            <i class="fas fa-trash-alt mr-1"></i>Xóa
                                        </button>
                                    </td>
                                </tr>`;
                            });
                            $(tableId).html(html);
                        },
                        error: function (xhr) {
                            console.error("Error loading data for " + tabName, xhr);
                            $(tableId).html("<tr><td colspan='6' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                        }
                    });
                    break;
                    case "GiamTruGiaCanh":
                        apiUrl = "/api/PayrollSettingApi/giam-tru-gia-canh";
                        tableId = "#giamTruGiaCanhTable tbody";
                        $.ajax({
                            url: apiUrl,
                            method: "GET",
                            success: function (data) {
                                $(tableId).empty();
                                var latestRecord = data
                                    .filter(item => !item.ngayHetHieuLuc)
                                    .sort((a, b) => new Date(b.ngayHieuLuc) - new Date(a.ngayHieuLuc))[0];
                                if (latestRecord) {
                                    html += `<tr class="hover:bg-gray-50">
                                        <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">1</td>
                                        <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${latestRecord.mucGiamTruBanThan.toLocaleString()}</td>
                                        <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${latestRecord.mucGiamTruNguoiPhuThuoc.toLocaleString()}</td>
                                        <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${new Date(latestRecord.ngayHieuLuc).toLocaleDateString()}</td>
                                        <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${latestRecord.ngayHetHieuLuc ? new Date(latestRecord.ngayHetHieuLuc).toLocaleDateString() : ''}</td>
                                        <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap">${latestRecord.ghiChu || ''}</td>
                                        <td class="px-4 py-2 text-sm border-b whitespace-nowrap text-center">
                                            <button class="edit-button inline-flex items-center px-2 py-1 rounded-lg bg-yellow-500 text-white hover:bg-yellow-600 transition-colors text-xs" onclick="openEditGiamTruGiaCanhModal(${latestRecord.id})">
                                                <i class="fas fa-edit mr-1"></i>Sửa
                                            </button>
                                        </td>
                                    </tr>`;
                                }
                                $(tableId).html(html || "<tr><td colspan='7' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Không có dữ liệu hiện hành</td></tr>");
                            },
                            error: function (xhr) {
                                console.error("Error loading data for " + tabName, xhr);
                                $(tableId).html("<tr><td colspan='7' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                            }
                        });
                        break;
            }
        }

        function openHistoryMucLuongCoSoModal() {
            var apiUrl = "/api/PayrollSettingApi/muc-luong-co-so";
            var tableId = "#historyMucLuongCoSoTable tbody";
            var html = "";
            $.ajax({
                url: apiUrl,
                method: "GET",
                success: function (data) {
                    $(tableId).empty();
                    var historyRecords = data.filter(item => item.ngayHetHieuLuc);
                    historyRecords.forEach(item => {
                        html += `<tr class="hover:bg-gray-50">
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.id}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.luongCoSo.toLocaleString()}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${new Date(item.ngayHieuLuc).toLocaleDateString()}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.ngayHetHieuLuc ? new Date(item.ngayHetHieuLuc).toLocaleDateString() : ''}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.ghiChu || ''}</td>
                        </tr>`;
                    });
                    $(tableId).html(html || "<tr><td colspan='5' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Không có dữ liệu lịch sử</td></tr>");
                    showModal("historyMucLuongCoSoModal");
                },
                error: function (xhr) {
                    console.error("Error loading history for MucLuongCoSo:", xhr);
                    $(tableId).html("<tr><td colspan='5' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                }
            });
        }

        function openHistoryThongTinBaoHiemModal() {
            var apiUrl = "/api/PayrollSettingApi/thong-tin-bao-hiem";
            var tableId = "#historyThongTinBaoHiemTable tbody";
            var html = "";
            $.ajax({
                url: apiUrl,
                method: "GET",
                success: function (data) {
                    $(tableId).empty();
                    var historyRecords = data.filter(item => item.ngayHetHieuLuc);
                    historyRecords.forEach(item => {
                        html += `<tr class="hover:bg-gray-50">
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.id}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.loaiBaoHiem}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.tyLeNguoiLaoDong}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.tyLeNhaTuyenDung}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${new Date(item.ngayHieuLuc).toLocaleDateString()}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.ngayHetHieuLuc ? new Date(item.ngayHetHieuLuc).toLocaleDateString() : ''}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b">${item.ghiChu || ''}</td>
                        </tr>`;
                    });
                    $(tableId).html(html || "<tr><td colspan='9' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Không có dữ liệu lịch sử</td></tr>");
                    showModal("historyThongTinBaoHiemModal");
                },
                error: function (xhr) {
                    console.error("Error loading history for ThongTinBaoHiem:", xhr);
                    $(tableId).html("<tr><td colspan='9' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                }
            });
        }

                function openCreateGiamTruGiaCanhModal() {
            $("#createGiamTruGiaCanhForm")[0].reset();
            $("#createGiamTruGiaCanhModal").show();
        }

        $("#createGiamTruGiaCanhForm").submit(function (e) {
            e.preventDefault();
            var data = {
                mucGiamTruBanThan: parseFloat($("#createMucGiamTruBanThan").val()),
                mucGiamTruNguoiPhuThuoc: parseFloat($("#createMucGiamTruNguoiPhuThuoc").val()),
                ngayHieuLuc: $("#createNgayHieuLucGTGC").val(),
                ngayHetHieuLuc: $("#createNgayHetHieuLucGTGC").val() || null,
                ghiChu: $("#createGhiChuGTGC").val()
            };
            $.ajax({
                url: "/api/PayrollSettingApi/giam-tru-gia-canh",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Tạo mới thành công!", "success");
                    closeModal('createGiamTruGiaCanhModal');
                    loadData('GiamTruGiaCanh');
                },
                error: function (xhr) {
                    console.error("Error creating GiamTruGiaCanh:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tạo mới dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openHistoryGiamTruGiaCanhModal() {
            var apiUrl = "/api/PayrollSettingApi/giam-tru-gia-canh";
            var tableId = "#historyGiamTruGiaCanhTable tbody";
            var html = "";
            var dot = 0;
            $.ajax({
                url: apiUrl,
                method: "GET",
                success: function (data) {
                    $(tableId).empty();
                    var historyRecords = data.filter(item => item.ngayHetHieuLuc);
                    historyRecords.forEach(item => {
                        dot++;
                        html += `<tr class="hover:bg-gray-50">
                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${dot}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${item.mucGiamTruBanThan.toLocaleString()}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${item.mucGiamTruNguoiPhuThuoc.toLocaleString()}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${new Date(item.ngayHieuLuc).toLocaleDateString()}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap text-center">${item.ngayHetHieuLuc ? new Date(item.ngayHetHieuLuc).toLocaleDateString() : ''}</td>
                            <td class="px-4 py-2 text-sm text-gray-600 border-b whitespace-nowrap">${item.ghiChu || ''}</td>
                        </tr>`;
                    });
                    $(tableId).html(html || "<tr><td colspan='6' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Không có dữ liệu lịch sử</td></tr>");
                    showModal("historyGiamTruGiaCanhModal");
                },
                error: function (xhr) {
                    console.error("Error loading history for GiamTruGiaCanh:", xhr);
                    $(tableId).html("<tr><td colspan='6' class='px-4 py-2 text-sm text-gray-600 border-b text-center'>Error loading data</td></tr>");
                }
            });
        }

        function openEditGiamTruGiaCanhModal(id) {
            $.ajax({
                url: `/api/PayrollSettingApi/giam-tru-gia-canh/${id}`,
                method: "GET",
                success: function (data) {
                    $("#editGiamTruGiaCanhId").val(data.id);
                    $("#editMucGiamTruBanThan").val(data.mucGiamTruBanThan);
                    $("#editMucGiamTruNguoiPhuThuoc").val(data.mucGiamTruNguoiPhuThuoc);
                    $("#editNgayHieuLucGTGC").val(new Date(data.ngayHieuLuc).toISOString().split('T')[0]);
                    $("#editNgayHetHieuLucGTGC").val(data.ngayHetHieuLuc ? new Date(data.ngayHetHieuLuc).toISOString().split('T')[0] : '');
                    $("#editGhiChuGTGC").val(data.ghiChu || '');
                    $("#editGiamTruGiaCanhModal").show();
                },
                error: function (xhr) {
                    console.error("Error fetching GiamTruGiaCanh:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tải dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        }

        $("#editGiamTruGiaCanhForm").submit(function (e) {
            e.preventDefault();
            var data = {
                id: parseInt($("#editGiamTruGiaCanhId").val()),
                mucGiamTruBanThan: parseFloat($("#editMucGiamTruBanThan").val()),
                mucGiamTruNguoiPhuThuoc: parseFloat($("#editMucGiamTruNguoiPhuThuoc").val()),
                ngayHieuLuc: $("#editNgayHieuLucGTGC").val(),
                ngayHetHieuLuc: $("#editNgayHetHieuLucGTGC").val() || null,
                ghiChu: $("#editGhiChuGTGC").val()
            };
            $.ajax({
                url: `/api/PayrollSettingApi/giam-tru-gia-canh/${data.id}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Cập nhật thành công!", "success");
                    closeModal('editGiamTruGiaCanhModal');
                    loadData('GiamTruGiaCanh');
                },
                error: function (xhr) {
                    console.error("Error updating GiamTruGiaCanh:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể cập nhật dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openCreateMucLuongCoSoModal() {
            $("#createMucLuongCoSoForm")[0].reset();
            $("#createMucLuongCoSoModal").show();
        }

        $("#createMucLuongCoSoForm").submit(function (e) {
            e.preventDefault();
            var data = {
                luongCoSo: parseFloat($("#createLuongCoSo").val()),
                ngayHieuLuc: $("#createNgayHieuLucCoSo").val(),
                ngayHetHieuLuc: $("#createNgayHetHieuLucCoSo").val() || null,
                ghiChu: $("#createGhiChuCoSo").val()
            };
            $.ajax({
                url: "/api/PayrollSettingApi/muc-luong-co-so",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Tạo mới thành công!", "success");
                    closeModal('createMucLuongCoSoModal');
                    loadData('MucLuongCoSo');
                },
                error: function (xhr) {
                    console.error("Error creating MucLuongCoSo:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tạo mới dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openCreateThongTinBaoHiemModal() {
            $("#createThongTinBaoHiemForm")[0].reset();
            $("#createThongTinBaoHiemModal").show();
        }

        $("#createThongTinBaoHiemForm").submit(function (e) {
            e.preventDefault();
            var data = {
                tyLeNguoiLaoDongBHXH: parseFloat($("#createTyLeNguoiLaoDongBHXH").val()),
                tyLeNhaTuyenDungBHXH: parseFloat($("#createTyLeNhaTuyenDungBHXH").val()),
                tyLeNguoiLaoDongBHYT: parseFloat($("#createTyLeNguoiLaoDongBHYT").val()),
                tyLeNhaTuyenDungBHYT: parseFloat($("#createTyLeNhaTuyenDungBHYT").val()),
                tyLeNguoiLaoDongBHTN: parseFloat($("#createTyLeNguoiLaoDongBHTN").val()),
                tyLeNhaTuyenDungBHTN: parseFloat($("#createTyLeNhaTuyenDungBHTN").val()),
                ngayHieuLuc: $("#createNgayHieuLucBH").val(),
                ngayHetHieuLuc: $("#createNgayHetHieuLucBH").val() || null,
                ghiChu: $("#createGhiChuBH").val()
            };
            $.ajax({
                url: "/api/PayrollSettingApi/thong-tin-bao-hiem",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Tạo mới thành công!", "success");
                    closeModal('createThongTinBaoHiemModal');
                    loadData('ThongTinBaoHiem');
                },
                error: function (xhr) {
                    console.error("Error creating ThongTinBaoHiem:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tạo mới dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openCreateCauHinhLuongThueModal() {
            $("#createCauHinhLuongThueForm")[0].reset();
            $("#createCauHinhLuongThueModal").show();
        }

        $("#createCauHinhLuongThueForm").submit(function (e) {
            e.preventDefault();
            var data = {
                mucLuongTu: parseFloat($("#createMucLuongTu").val()) || null,
                mucLuongDen: parseFloat($("#createMucLuongDen").val()) || null,
                giaTri: parseFloat($("#createGiaTri").val()),
                moTa: $("#createMoTa").val()
            };
            $.ajax({
                url: "/api/PayrollSettingApi/cau-hinh-luong-thue",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Tạo mới thành công!", "success");
                    closeModal('createCauHinhLuongThueModal');
                    loadData('CauHinhLuongThue');
                },
                error: function (xhr) {
                    console.error("Error creating CauHinhLuongThue:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tạo mới dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openEditMucLuongToiThieuVungModal(id) {
            $.ajax({
                url: `/api/PayrollSettingApi/muc-luong-toi-thieu-vung/${id}`,
                method: "GET",
                success: function (data) {
                    $("#editMucLuongToiThieuVungId").val(data.vungLuong);
                    $("#editMucLuongToiThieuThang").val(data.mucLuongToiThieuThang);
                    $("#editMucLuongToiThieuGio").val(data.mucLuongToiThieuGio);
                    $("#editIsActive").prop("checked", data.isActive);
                    $("#editMucLuongToiThieuVungModal").show();
                },
                error: function (xhr) {
                    console.error("Error fetching MucLuongToiThieuVung:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tải dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        }

        $("#editMucLuongToiThieuVungForm").submit(function (e) {
            e.preventDefault();
            var data = {
                vungLuong: parseInt($("#editMucLuongToiThieuVungId").val()),
                mucLuongToiThieuThang: parseFloat($("#editMucLuongToiThieuThang").val()),
                mucLuongToiThieuGio: parseFloat($("#editMucLuongToiThieuGio").val()),
                isActive: $("#editIsActive").is(":checked")
            };
            $.ajax({
                url: `/api/PayrollSettingApi/muc-luong-toi-thieu-vung/${data.vungLuong}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Cập nhật thành công!", "success");
                    closeModal('editMucLuongToiThieuVungModal');
                    loadData('MucLuongToiThieuVung');
                },
                error: function (xhr) {
                    console.error("Error updating MucLuongToiThieuVung:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể cập nhật dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openEditMucLuongCoSoModal(id) {
            $.ajax({
                url: `/api/PayrollSettingApi/muc-luong-co-so/${id}`,
                method: "GET",
                success: function (data) {
                    $("#editMucLuongCoSoId").val(data.id);
                    $("#editLuongCoSo").val(data.luongCoSo);
                    $("#editNgayHieuLucCoSo").val(new Date(data.ngayHieuLuc).toISOString().split('T')[0]);
                    $("#editNgayHetHieuLucCoSo").val(data.ngayHetHieuLuc ? new Date(data.ngayHetHieuLuc).toISOString().split('T')[0] : '');
                    $("#editGhiChuCoSo").val(data.ghiChu || '');
                    $("#editMucLuongCoSoModal").show();
                },
                error: function (xhr) {
                    console.error("Error fetching MucLuongCoSo:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tải dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        }

        $("#editMucLuongCoSoForm").submit(function (e) {
            e.preventDefault();
            var data = {
                id: parseInt($("#editMucLuongCoSoId").val()),
                luongCoSo: parseFloat($("#editLuongCoSo").val()),
                ngayHieuLuc: $("#editNgayHieuLucCoSo").val(),
                ngayHetHieuLuc: $("#editNgayHetHieuLucCoSo").val() || null,
                ghiChu: $("#editGhiChuCoSo").val()
            };
            $.ajax({
                url: `/api/PayrollSettingApi/muc-luong-co-so/${data.id}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Cập nhật thành công!", "success");
                    closeModal('editMucLuongCoSoModal');
                    loadData('MucLuongCoSo');
                },
                error: function (xhr) {
                    console.error("Error updating MucLuongCoSo:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể cập nhật dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openEditThongTinBaoHiemModal(id) {
            $.ajax({
                url: `/api/PayrollSettingApi/thong-tin-bao-hiem/${id}`,
                method: "GET",
                success: function (data) {
                    $("#editThongTinBaoHiemId").val(data.id);
                    $("#editLoaiBaoHiemDisplay").val(data.loaiBaoHiem);
                    $("#editLoaiBaoHiem").val(data.loaiBaoHiem);
                    $("#editTyLeNguoiLaoDong").val(data.tyLeNguoiLaoDong);
                    $("#editTyLeNhaTuyenDung").val(data.tyLeNhaTuyenDung);
                    $("#editNgayHieuLucBH").val(data.ngayHieuLuc.split("T")[0]);
                    $("#editNgayHetHieuLucBH").val(data.ngayHetHieuLuc ? data.ngayHetHieuLuc.split("T")[0] : "");
                    $("#editGhiChuBH").val(data.ghiChu);
                    showModal("editThongTinBaoHiemModal");
                },
                error: function (xhr) {
                    console.error("Error fetching ThongTinBaoHiem:", xhr);
                    Swal.fire("Lỗi!", "Không thể tải dữ liệu.", "error");
                }
            });
        }

        $("#editThongTinBaoHiemForm").submit(function (e) {
            e.preventDefault();
            var data = {
                id: parseInt($("#editThongTinBaoHiemId").val()),
                loaiBaoHiem: $("#editLoaiBaoHiem").val(),
                tyLeNguoiLaoDong: parseFloat($("#editTyLeNguoiLaoDong").val()),
                tyLeNhaTuyenDung: parseFloat($("#editTyLeNhaTuyenDung").val()),
                ngayHieuLuc: $("#editNgayHieuLucBH").val(),
                ngayHetHieuLuc: $("#editNgayHetHieuLucBH").val() || null,
                ghiChu: $("#editGhiChuBH").val()
            };
            $.ajax({
                url: `/api/PayrollSettingApi/thong-tin-bao-hiem/${data.id}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Cập nhật thành công!", "success");
                    closeModal('editThongTinBaoHiemModal');
                    loadData('ThongTinBaoHiem');
                },
                error: function (xhr) {
                    console.error("Error updating ThongTinBaoHiem:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể cập nhật dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

        function openEditCauHinhLuongThueModal(id) {
            $.ajax({
                url: `/api/PayrollSettingApi/cau-hinh-luong-thue/${id}`,
                method: "GET",
                success: function (data) {
                    $("#editMaCauHinh").val(data.maCauHinh);
                    $("#editMucLuongTu").val(data.mucLuongTu || '');
                    $("#editMucLuongDen").val(data.mucLuongDen || '');
                    $("#editGiaTri").val(data.giaTri);
                    $("#editMoTa").val(data.moTa || '');
                    $("#editCauHinhLuongThueModal").show();
                },
                error: function (xhr) {
                    console.error("Error fetching CauHinhLuongThue:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể tải dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        }

        $("#editCauHinhLuongThueForm").submit(function (e) {
            e.preventDefault();
            var data = {
                maCauHinh: parseInt($("#editMaCauHinh").val()),
                mucLuongTu: parseFloat($("#editMucLuongTu").val()) || null,
                mucLuongDen: parseFloat($("#editMucLuongDen").val()) || null,
                giaTri: parseFloat($("#editGiaTri").val()),
                moTa: $("#editMoTa").val()
            };
            $.ajax({
                url: `/api/PayrollSettingApi/cau-hinh-luong-thue/${data.maCauHinh}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function () {
                    Swal.fire("Thành công!", "Cập nhật thành công!", "success");
                    closeModal('editCauHinhLuongThueModal');
                    loadData('CauHinhLuongThue');
                },
                error: function (xhr) {
                    console.error("Error updating CauHinhLuongThue:", xhr);
                    var errorMessage = xhr.responseJSON?.message || "Không thể cập nhật dữ liệu.";
                    Swal.fire("Lỗi!", errorMessage, "error");
                }
            });
        });

               function deleteCauHinhLuongThue(id) {
            Swal.fire({
                title: "Bạn có chắc muốn xóa không?",
                text: "Hành động này không thể hoàn tác!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Có, xóa!",
                cancelButtonText: "Hủy"
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        url: `/api/PayrollSettingApi/cau-hinh-luong-thue/${id}`,
                        method: "DELETE",
                        success: function () {
                            Swal.fire("Thành công!", "Đã xóa thành công!", "success");
                            loadData('CauHinhLuongThue');
                        },
                        error: function (xhr) {
                            console.error("Error deleting CauHinhLuongThue:", xhr);
                            var errorMessage = xhr.responseJSON?.message || "Không thể xóa dữ liệu.";
                            Swal.fire("Lỗi!", errorMessage, "error");
                        }
                    });
                }
            });
        }

        // Initialize the first tab
        document.getElementsByClassName("tablinks")[0].click();

        // jQuery to handle modal display
        $(".modal").hide();
        function showModal(modalId) {
            $("#" + modalId).show();
        }
    </script>
}